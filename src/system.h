#ifndef SYSTEM_H
#define SYSTEM_H
#include <random>

#include "display.h"

class System {

  // Memory and general purpose registers
  union {
    unsigned char memory[0x1000];
    unsigned char symbols[80] = {
      0xF0, 0x90, 0x90, 0x90, 0xF0,    // 0
      0x20, 0x60, 0x20, 0x20, 0x70,    // 1
      0xF0, 0x10, 0xF0, 0x80, 0xF0,    // 2
      0xF0, 0x10, 0xF0, 0x10, 0xF0,    // 3
      0x90, 0x90, 0xF0, 0x10, 0x10,    // 4
      0xF0, 0x80, 0xF0, 0x10, 0xF0,    // 5
      0xF0, 0x80, 0xF0, 0x90, 0xF0,    // 6
      0xF0, 0x10, 0x20, 0x40, 0x40,    // 7
      0xF0, 0x90, 0xF0, 0x90, 0xF0,    // 8
      0xF0, 0x90, 0xF0, 0x10, 0xF0,    // 9
      0xF0, 0x90, 0xF0, 0x90, 0x90,    // A
      0xE0, 0x90, 0xE0, 0x90, 0xE0,    // B
      0xF0, 0x80, 0x80, 0x80, 0xF0,    // C
      0xE0, 0x90, 0x90, 0x90, 0xE0,    // D
      0xF0, 0x80, 0xF0, 0x80, 0xF0,    // E
      0xF0, 0x80, 0xF0, 0x80, 0x80};   // F
  };

  unsigned char V[0x10];

  // Special purpose registers
  unsigned short I;
  unsigned short pc;

  // Stack
  unsigned short stack[16];
  unsigned char sp;


  FrameBuffer frameBuffer;
  std::mt19937 rng;

  unsigned char rand();

  public:
  // delay and sound registers need to be accessed by main loop
  unsigned char delay, sound;

  System(char* romPath);
  void fetchExecute();

};

#endif